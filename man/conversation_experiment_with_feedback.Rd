% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/conversation_experiment_with_feedback.R
\name{conversation_experiment_with_feedback}
\alias{conversation_experiment_with_feedback}
\title{Run LLM Conversation Experiment with Feedback}
\usage{
conversation_experiment_with_feedback(
  data,
  repeats = 1,
  random = FALSE,
  api_key,
  model,
  api_url,
  trial_prompt = "",
  feedback_fn,
  apply_mode = c("replace_next", "insert_dynamic"),
  role_mapping = list(user = "user", system = "system", assistant = "assistant"),
  system_prompt = "You are a participant in a psychology experiment.",
  max_trials = 50,
  delay = 1,
  output_path = "experiment_results.csv",
  enable_thinking = FALSE,
  ...
)
}
\arguments{
\item{data}{Data frame or file path with at least `TrialPrompt` and `Material`.}

\item{repeats}{Number of times to repeat materials.}

\item{random}{Shuffle trial order.}

\item{api_key}{API key for the LLM.}

\item{model}{LLM model name.}

\item{api_url}{LLM API endpoint.}

\item{trial_prompt}{Initial prompt prefix for each trial.}

\item{feedback_fn}{Function(response, row, conversation) returning list(name, next_prompt, meta).}

\item{apply_mode}{"replace_next" = overwrite next row, "insert_dynamic" = insert new row.}

\item{role_mapping}{Mapping for roles: user/system/assistant.}

\item{system_prompt}{Initial system message.}

\item{max_trials}{Maximum trials to run.}

\item{delay}{Delay (seconds) between trials.}

\item{output_path}{File path to save results.}

\item{enable_thinking}{Logical; enable chain-of-thought.}

\item{...}{Extra arguments passed to `llm_caller`.}
}
\value{
Data frame of trial results.
}
\description{
Sequentially sends trials to an LLM, keeps conversation history,
and applies user-defined feedback to modify subsequent prompts.
}
