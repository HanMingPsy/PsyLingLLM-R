% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/register_entry.R
\name{build_registry_entry_from_analysis}
\alias{build_registry_entry_from_analysis}
\title{Build a registry entry from analysis results}
\usage{
build_registry_entry_from_analysis(
  model,
  analysis,
  provider = "official",
  generation_interface = NULL,
  url = NULL,
  headers_input = NULL,
  role_mapping_input = NULL,
  stream_param = NULL,
  optional_defaults = NULL
)
}
\arguments{
\item{model}{Character(1). Model identifier, e.g. `"deepseek-chat"`.}

\item{analysis}{List. The result from `analyze_llm_endpoint()` containing `pass1` and `pass2` nodes.}

\item{provider}{Character(1). Free-form provider tag, e.g. `"official"`, `"chutes.ai"`, or `"local"`.}

\item{generation_interface}{Character(1). Interface name (defaults to `"chat"`).
If `NULL`, it will be inferred automatically via `classify_generation_interface()`.}

\item{url}{Character(1). Base URL; persisted as `default_url` only if `provider == "official"`.}

\item{headers_input}{Named list or `NULL`. Custom HTTP headers.
If `NULL`, Pass-1 raw headers are used.}

\item{role_mapping_input}{List or `NULL`. Custom role mapping.
If `NULL`, the function infers mappings from Pass-1/Pass-2 bodies.}

\item{stream_param}{Character scalar (optional).}

\item{optional_defaults}{Named list. Default generation parameters
(e.g. `list(stream = TRUE, max_tokens = 512)`), stored under `input.optional_defaults`.}
}
\value{
A named list representing a single registry node, keyed by `"<model>@<provider>"`.
Each entry contains a nested structure describing model I/O, streaming behavior,
token usage paths, and reasoning capabilities.
}
\description{
This function constructs a structured registry node from
the results of an endpoint analysis, typically produced by
`analyze_llm_endpoint()`. It merges information from Pass-1
and Pass-2 analysis stages, preserving vendor-specific fields,
normalizing optional parameters, and ensuring YAML-ready
formatting for downstream usage.
}
\details{
**Changes vs previous version:**
- Omits `method` entirely when not provided (no `method: ~` in YAML).
- In Pass-2 body, \code{"\${PARAMETER}"} fields are stored as `NULL` (`~` in YAML) for cleaner output.
- Accepts `optional_defaults` as a named list (e.g., `list(stream = TRUE, max_tokens = 512)`)
  and stores it under `input.optional_defaults`.
}
\seealso{
[analyze_llm_endpoint()], [classify_generation_interface()]
}
